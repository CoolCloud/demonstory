define("mod/template",["mod/lang"],function(a){a=a||Ark._;var b={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"};for(var g in b){b[b[g]]=g}var e=/\\|'|\r|\n|\t|\u2028|\u2029/g;var d=/\\(\\|'|r|n|t|u2028|u2029)/g;var f=function(h){return h.replace(d,function(i,j){return b[j]})};var c=function(m,l,j){j=a.extend(j||{},{evaluate:/\{\{([\s\S]+?)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,escape:/\{\{-([\s\S]+?)\}\}/g});var k="__p+='"+m.replace(e,function(n){return"\\"+b[n]}).replace(j.escape,function(n,o){return"'+\n_.escape("+f(o)+")+\n'"}).replace(j.interpolate,function(n,o){return"'+\n("+f(o)+")+\n'"}).replace(j.evaluate,function(n,o){return"';\n"+f(o)+"\n;__p+='"})+"';\n";if(!j.variable){k="with(obj||{}){\n"+k+"}\n"}k="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+k+"return __p;\n";var i=new Function(j.variable||"obj","_",k);if(l){return i(l,a)}var h=function(n){return i.call(this,n,a)};h.source="function("+(j.variable||"obj")+"){\n"+k+"}";return h};return c});