define("widget/profile",["jquery","mod/cookie","mod/template"],function(f,c,n){f=f||window.$;c=c||Ark.cookie;n=n||Ark.template;var i=f("body"),b=f("#ark-console"),g=f(".profile-hd"),m=f(".profile-bd"),l=f(".profile-ft"),k=f(".profile-hd, .profile-bd"),h=f("#tmpl-console-item").html(),e=document.documentElement,j=location,d={};d.add=function(p){var r=p.uri.split("/"),o=r.slice(-1),q=r.slice(0,-1).join("/");m.find("tbody").append(n(h,{name:o,path:q||"/",time:p.time,method:p.type.toUpperCase(),stdout:p.stdout}));l.find(".req-num").text(f("td[data-stdout]").length)};g.dblclick(function(){var o=/height:+/gi.test(b.attr("style"));b.height(o?"":e.clientHeight);m.css("max-height",o?"300px":"100%")});l.on("click",function(r){var o=f(this),q=o.find(".switcher"),p=q.hasClass("off");k.toggle();q.toggleClass("on off");o.toggleClass("mini").find(".apc").text(p?"Ark Profiling Console":"APC")});b.on("click","[data-stdout]",function(){var p=f(this),o=p.find(".stdout");if(f.trim(o.text()).length){return o.empty()}o.html(p.data("stdout")).show().end().find("pre").width(i.width())});if(/profile=shire/gi.test(j.search)||c("profile")){var a=f("#shire-profile");if(!a){return}d.add({uri:j.href,time:a.data("pt"),stdout:a.html(),type:"GET"})}return d});